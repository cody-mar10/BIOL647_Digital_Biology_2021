# #+TITLE: Digital Biology
#+AUTHOR: Rodolfo Aramayo
#+EMAIL: raramayo@tamu.edu
#+STARTUP: align
* *Next Generation DNA Sequencing*
** *ILLUMINA SEQUENCING AND FASTQ FORMAT*
*** *ILLUMINA SEQUENCING*
| [[./00Data/T10T11Data/BIOL647_E00/Slide01.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide02.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide03.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide04.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide05.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide06.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide07.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide08.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide09.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide10.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide11.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide12.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide13.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide14.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide15.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide16.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide17.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide18.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide19.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide20.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide21.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide22.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide23.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide24.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide25.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide26.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide27.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide28.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide29.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide30.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide31.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide32.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide33.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide34.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide35.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide36.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide37.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide38.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide39.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide40.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide41.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide42.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide43.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide44.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide45.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide46.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide47.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide48.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide49.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide50.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide51.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide52.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide53.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide54.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide55.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide56.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide57.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide58.png]] |
*** *FASTQ FILE FORMAT*
| [[./00Data/T10T11Data/BIOL647_E00/Slide59.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide60.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide61.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide62.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide63.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide64.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide65.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide66.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide67.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide68.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide69.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide70.png]] |
+ Definition: FASTQ file is a text-based file format that contains base calls and quality values per read. Each record contains 4 lines:
  + The identifier
  + The sequence
  + A plus sign (+)
  + The quality scores in an ASCII encoded format
+ Example:
  :
  :  @SRR014370.66615_ingolia_4_2_1579_1366_length=36  <-- @title and optional description
  :  GACGTTGAAACCTTATCAGTATCTGAAAAAAA                  <-- sequence line(s)
  :  +                                                 <-- optional repeat of title line
  :  IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII                  <-- quality line(s)
+ Identifiers Table
   |----------------+--------------------------------------------------------------------------------------------------------------------------|
   | Identifiers    | Description                                                                                                              |
   |----------------+--------------------------------------------------------------------------------------------------------------------------|
   | @              | Each sequence identifier line starts with @                                                                              |
   | instrument     | The instrument ID                                                                                                        |
   | run number     | The run number on the instrument                                                                                         |
   | flowcell ID    | The flowcell ID                                                                                                          |
   | lane           | The lane number                                                                                                          |
   | tile           | The tile number                                                                                                          |
   | x_pos          | The X coordinate of the cluster                                                                                          |
   | y_pos          | The Y coordinate of the cluster                                                                                          |
   | UMI            | [Optional]                                                                                                               |
   |                | The Unique Molecular Identifiers (UMIs) are restricted to A/T/G/C/N.                                                     |
   |                | The UMI sequences for Read 1 and Read 1 are separated by a plus sign (+) when the UMIs are specified in the sample sheet |
   | read           | Read 1—Single read                                                                                                       |
   |                | Read 2—Paired-end read                                                                                                   |
   | is filtered    | Y—The read is filtered                                                                                                   |
   |                | N—The read is not filtered                                                                                               |
   | control number | 0—No control bits are turned on                                                                                          |
   |                | Even number—Control bits are turned on                                                                                   |
   | index          | The Index reads are restricted to A/T/G/C/N                                                                              |
   |----------------+--------------------------------------------------------------------------------------------------------------------------|
+ FASTQ Control Values

    When the read is identified as a control value, the number is greater than 0 and
    the value specifies the type of control.  When the read is not identified as a
    control, the 10th column is 0.  The value is the decimal representation of a
    bit-wise encoding scheme.  The scheme bit 0 has a decimal value of 1; bit 1 has
    a value of 2, bit 2 has a value of 4, and so on
  + Quality Scores

    A quality score, or Q-score, is a prediction of the probability of an incorrect
    base call. A higher Q-score implies that a base call is more reliable Based on
    the Phred scale, the Q-score serves as a compact way to communicate small error
    probabilities. Given a base call, X, the probability that X is not true, P(~X),
    results in a quality score, Q(X), according to the relationship:

    : Q(X) = -10 log10(P(~X))

    where P(~X) is the estimated error probability

   |--------------------------+-------------------------+--------------------|
   | Phred Quality Score Q(X) | Error Probability P(~X) | Accuracy (1-error) |
   |--------------------------+-------------------------+--------------------|
   | Q40                      | 0.0001 (1 in 10,000)    |             99.99% |
   | Q30                      | 0.001 (1 in 1,000)      |             99.90% |
   | Q20                      | 0.01 (1 in 100)         |             99.00% |
   | Q10                      | 0.1 (1 in 10)           |             90.00% |
   |--------------------------+-------------------------+--------------------|

    During the sequencing run, base call quality scores are calculated after cycle
    25 and results are recorded in base call (*.bcl) files, which contain the base
    call and quality score per cycle
  + Quality Scores Encoding

    In FASTQ files, quality scores are encoded into a compact form, which uses only
    1 byte per quality value. In this encoding, the quality score is represented as
    the character with an ASCII code equal to its value + 33. The following table
    demonstrates the relationship between the encoding character, its ASCII code,
    and the quality score represented
  + ASCII Characters Encoding Q-scores 0–40

   |--------+------------+---------+---+--------+------------+---------|
   | Symbol | ASCII Code | Q-Score |   | Symbol | ASCII Code | Q-Score |
   |--------+------------+---------+---+--------+------------+---------|
   | \!     |         33 |       0 |   | 6      |         54 |      21 |
   | "      |         34 |       1 |   | 7      |         55 |      22 |
   | \#     |         35 |       2 |   | 8      |         56 |      23 |
   | \$     |         36 |       3 |   | 9      |         57 |      24 |
   | %      |         37 |       4 |   | :      |         58 |      25 |
   | &      |         38 |       5 |   | ;      |         59 |      26 |
   | '      |         39 |       6 |   | <      |         60 |      27 |
   | (      |         40 |       7 |   | \=     |         61 |      28 |
   | )      |         41 |       8 |   | >      |         62 |      29 |
   | \*     |         42 |       9 |   | ?      |         63 |      30 |
   | +      |         43 |      10 |   | @      |         64 |      31 |
   | ,      |         44 |      11 |   | A      |         65 |      32 |
   | -      |         45 |      12 |   | B      |         66 |      33 |
   | .      |         46 |      13 |   | C      |         67 |      34 |
   | \/     |         47 |      14 |   | D      |         68 |      35 |
   | 0      |         48 |      15 |   | E      |         69 |      36 |
   | 1      |         49 |      16 |   | F      |         70 |      37 |
   | 2      |         50 |      17 |   | G      |         71 |      38 |
   | 3      |         51 |      18 |   | H      |         72 |      39 |
   | 4      |         52 |      19 |   | I      |         73 |      40 |
   | 5      |         53 |      20 |   |        |            |         |
   |--------+------------+---------+---+--------+------------+---------|
+ *[[https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2847217/][ORIGINAL FASTQ PAPER]]*
+ *[[https://gatk.broadinstitute.org/hc/en-us/articles/360035531872?id=4260][PHRED-SCALED QUALITY SCORES EXPLAINED]]*
+ *[[https://broadinstitute.github.io/picard/explain-qualities.html][DECODING BASE QUALITIES]]*
** *PACBIO SEQUENCING*
| [[./00Data/T10T11Data/BIOL647_E00/Slide71.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide72.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide73.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide74.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide75.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide76.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide77.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide78.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide79.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide80.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide81.png]] |
** *OXFORD NANOPORE SEQUENCING*
| [[./00Data/T10T11Data/BIOL647_E00/Slide82.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide83.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide84.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide85.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide86.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide87.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide88.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide89.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide90.png]] |
| [[./00Data/T10T11Data/BIOL647_E00/Slide91.png]] |
* 
| *Navigation:*             | *[[https://github.tamu.edu/DigitalBiology/BIOL647_Digital_Biology_2021/wiki][Home]]*                                                                       |
| *Author: [[raramayo@tamu.edu][Rodolfo Aramayo]]* | *License: [[http://creativecommons.org/licenses/by-nc-sa/4.0/][All content produced in this site is licensed by: CC BY-NC-SA 4.0]]* |
